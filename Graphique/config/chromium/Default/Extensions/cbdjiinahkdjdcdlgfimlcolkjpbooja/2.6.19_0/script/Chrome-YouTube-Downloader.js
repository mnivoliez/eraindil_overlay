function $(e){return document.getElementById(e)}function runScript(){function a(){chrome.extension.sendRequest({method:"completerequest"},function(e){var t="";if($("eow-title")){t=$("eow-title").innerText.replace(/[\\~#%*{}\/<>?|"]/g,"_").replace(/&/g,"and");console.log("CHYD - OK - Parse video title: "+t);t=encodeURIComponent(t)}else if($("watch-headline-title")){t=encodeURIComponent($("watch-headline-title").innerText.replace(/[\\~#%*{}\/<>?|"]/g,"_").replace(/&/g,"and"))}else{t="Unknown title";console.log("CHYD - WARNING! - Unknown video title")}var r="";if(e.username=="true"&&$("watch7-user-header")){if($("watch7-user-header").getElementsByTagName("a")[1].innerText){r=$("watch7-user-header").getElementsByTagName("a")[1].innerText+" - ";console.log("CHYD - OK - Parse username: "+$("watch7-user-header").getElementsByTagName("a")[1].innerText)}else if(e.username=="false"){r=""}else{r="Unknown username - ";console.log("CHYD - WARNING! Parsing username FAILED!")}}if(e.quality=="true"){u=Array(" [H.263 240p]"," [H.264 360p]"," [H.264 480p]"," [H.264 720p]"," [H.264 1080p]"," [H.264 1536p]")}var i=window.location.href.split(/v=/)[1].split("&")[0];console.log("CHYD - OK - This video ID: "+i);var s=window.location.href.split("?")[0]+"?v="+i;console.log("CHYD - OK - This video URL: "+s);if($("movie_player")&&$("movie_player").tagName=="EMBED"){var a=$("movie_player").getAttribute("flashvars");if(a.match(/url_encoded_fmt_stream_map=(.*?)&/)){a=unescape(a.match(/url_encoded_fmt_stream_map=(.*?)&/))}else if(a.match(/url_encoded_fmt_stream_map=(.*?)$/)[1]){a=unescape(a.match(/url_encoded_fmt_stream_map=(.*?)$/)[1])}console.log('CHYD - OK - Parsing from element "movie_player"')}else{var f=document.getElementsByTagName("script");for(var l=0,c=f.length;l<c;l++){if(f[l].innerHTML.match(/"url_encoded_fmt_stream_map": "(.*?)"/)){a=f[l].innerHTML.match(/"url_encoded_fmt_stream_map": "(.*?)"/);a=a[1].replace(/\\u([0-9]+)/g,function(e,t){return decodeURIComponent("%"+parseFloat(t));console.log("CHYD - OK - Parsing from script")})}else{a=null;console.log('CHYD - WARNING! - Unknown "fmt_url_map"')}}}console.log("CHYD - OK - Getting to fmt_url_map");var h=new Array;h=a.split(",");var p=0,d=0,v=0,m=0,g=0,y=0,b=0,w=0,E=0;var S=new String;var x=new String;console.log("CHYD - OK - Parsing video links start");for(l=0;l<h.length;l++){var T=parseInt((h[l].match(/itag=([0-9]*)&/)||h[l].match(/itag=([0-9]*)$/))[1]);var N=null;if(h[l].match(/sig=(.*?)&/)){N=h[l].match(/sig=(.*?)&/)[1]}else if(h[l].match(/sig=(.*?)$/)){N=h[l].match(/sig=(.*?)$/)[1]}else{if(h[l].match(/&s=(.*?)&/)){N=h[l].match(/&s=(.*?)&/)[1]}else if(h[l].match(/&s=(.*?)$/)){N=h[l].match(/&s=(.*?)$/)[1]}else{N=""}console.log("CHYD - WARNING! Parsing signature FAILED!")}h[l]=unescape((h[l].match(/url=(.*?)&/)||h[l].match(/url=(.*?)$/))[1])+"&signature="+N;var C=new Array;C=T;if(C=="5"&&e.lq=="true"&&p==0){S+='<a target="iframe" href="'+h[l]+"&title="+r+t+u[0]+'"><span class="yt-uix-button-menu-item" id="v240p">FLV (240p)</span></a>';p++}else{null}if(C=="18"&&e.mq=="true"&&d==0){S+='<a target="iframe" href="'+h[l]+"&title="+r+t+u[1]+'"><span class="yt-uix-button-menu-item" id="v360p">MP4 (360p)</span></a>';d++}else{null}if(C=="43"&&e.webm=="true"&&v==0){S+='<a target="iframe" href="'+h[l]+"&title="+r+t+'"><span class="yt-uix-button-menu-item" id="wm360p">WebM (360p)</span></a>';v++}else{null}if(C=="35"&&e.hq=="true"&&m==0){S+='<a target="iframe" href="'+h[l]+"&title="+r+t+u[2]+'"><span class="yt-uix-button-menu-item" id="v480p">FLV (480p)</span></a>';m++}else{null}if(C=="44"&&e.webm=="true"&&g==0){S+='<a target="iframe" href="'+h[l]+"&title="+r+t+'"><span class="yt-uix-button-menu-item" id="wm480p">WebM (480p)</span></a>';g++}else{null}if(C=="22"&&e.hd=="true"&&y==0){S+='<a target="iframe" href="'+h[l]+"&title="+r+t+u[3]+'"><span class="yt-uix-button-menu-item" id="v720p">MP4 HD (720p)</span></a>';y++}else{null}if(C=="45"&&e.webm=="true"&&b==0){S+='<a target="iframe" href="'+h[l]+"&title="+r+t+'"><span class="yt-uix-button-menu-item" id="wm720p">WebM HD (720p)</span></a>';b++}else{null}if(C=="37"&&e.fhd=="true"&&w==0){S+='<a target="iframe" href="'+h[l]+"&title="+r+t+u[4]+'"><span class="yt-uix-button-menu-item" id="v1080p">MP4 HD (1080p)</span></a>';w++}else{null}if(C=="38"&&e.uhd=="true"&&E==0){S+='<a target="iframe" href="'+h[l]+"&title="+r+t+u[5]+'"><span class="yt-uix-button-menu-item"  id="v2k">MP4 HD (2K)</span></a>';E++}else{null}}console.log("CHYD - OK - Parsing video links end");for(l=0;l<h.length;l++){var T=parseInt((h[l].match(/itag=([0-9]*)&/)||h[l].match(/itag=([0-9]*)$/))[1]);var C=new Array;C=T;h[l]=decodeURIComponent(h[l]);var k="";if(e.quality=="true"&&C=="38"&&e.uduhd=="true"){k=" [H.264 4k]"}else if(e.quality=="true"&&C=="37"&&e.udfhd=="true"){k=" [H.264 1080p]"}else if(e.quality=="true"&&C=="22"&&e.udhd=="true"){k=" [H.264 720p]"}else if(e.quality=="true"&&C=="35"&&e.udhq=="true"){k=" [H.264 480p]"}else if(e.quality=="true"&&C=="18"&&e.udmq=="true"){k=" [H.264 240p~360p]"}else if(e.quality=="true"&&C=="5"&&e.udlq=="true"){k=" [H.263 240p]"}if(C=="38"&&e.uduhd=="true"||C=="37"&&e.udfhd=="true"||C=="22"&&e.udhd=="true"||C=="35"&&e.udhq=="true"||C=="18"&&e.udmq=="true"||C=="5"&&e.udlq=="true"){x+='<a target="iframe" href="'+h[l]+"&title="+r+t+k+'">'+n[1]+"</a>";break}}if(e.ytmp3=="true"){S+='<a href="http://www.flvto.com/?url='+s+'" target="_blank"><span class="yt-uix-button-menu-item" id="ytmp3">MP3 (Flvto)</span></a>'}else{null}if(e.v2mp3=="true"){S+='<a href="http://www.video2mp3.net/?url='+s+'&hq=1" target="_blank"><span class="yt-uix-button-menu-item" id="v2mp3">MP3 (Video2mp3)</span></a>'}else{null}if(e.nstyle=="true"&&$("watch7-user-header")){$("watch7-user-header").innerHTML+='<div id="watch-actions-center-new"><iframe name="iframe"></iframe><span class="yt-uix-button-group"><button id="download" class="start yt-uix-button yt-uix-tooltip yt-uix-button-subscribe-branded yt-uix-button-default" data-tooltip-text="'+n[0]+'" data-tooltip-timer="625" title="" data-tooltip="'+n[0]+'"><span class="yt-uix-button-content">'+x+'</span></button><button id="menu" class="end yt-uix-tooltip yt-uix-button yt-uix-button-subscribe-branded yt-uix-button-empty yt-uix-button-default" onclick=";return false;" data-tooltip-text="'+n[2]+'" data-tooltip-timer="625" title="" data-tooltip="'+n[2]+'" data-button-listener="16" data-content-id="yt-uix-tooltip2-content"><span class="yt-uix-button-content"><img class="yt-uix-button-arrow"></span><ul id="stylelist" class="yt-uix-button-menu hid">'+o+S+"</ul></button></span></div>";console.log("CHYD - OK - Set new style")}else if(e.cstyle=="true"&&$("watch7-user-header")){$("watch7-user-header").innerHTML+='<div id="watch-actions-center-clasic"><iframe name="iframe"></iframe><button id="download" class="yt-uix-button yt-uix-tooltip yt-uix-button-subscribe-branded yt-uix-button-default" onclick=";return false;" data-tooltip-text="'+n[0]+'" data-tooltip-timer="625" title="" data-tooltip="'+n[0]+'" data-button-listener="16" data-content-id="yt-uix-tooltip2-content"><span class="yt-uix-button-content">'+n[1]+'</span><img class="yt-uix-button-arrow" style="margin-right:8px;"><ul id="stylelist" class="yt-uix-button-menu hid">'+o+S+"</ul></button></div>";console.log("CHYD - OK - Set clasic style")}else{console.log("CHYD - WARNING! Including button FAILED!")}})}console.log("CHYD - OK - Runing");if(document.getElementsByTagName("html").item(0).lang&&document.getElementsByTagName("body").item(0).className){var e=document.getElementsByTagName("html").item(0).lang;var t=document.getElementsByTagName("body").item(0).className;var n=Array("Download this video!","Download","Download specific format");if(e=="cs"){n=Array("Stáhnout video!","Stáhnout","Stáhnout konkrétní formát")}if(e=="de"){n=Array("Dieses video herunterladen!","Download","Download bestimmten format")}if(e=="en"){n=Array("Download this video!","Download","Download specific format")}if(e=="es"){n=Array("Descargar este vídeo!","Descargar","Descargar formato específico")}if(e=="sk"){n=Array("Stiahnut toto video!","Stiahnut","Stiahnut konkrétny formát")}if(e=="it"){n=Array("Scarica il video!","Download","Scarica formato specifico")}if(e=="pl"){n=Array("Pobierz wideo!","Pobierz","Pobierz konkretnym formacie")}if(e=="ru"){n=Array("Скачать это видео!","Скачать","Скачать определенный формат")}if(e=="hr"){n=Array("Preuzmi ovaj video!","Download","Preuzimanje specificnom formatu")}if(e=="fr"){n=Array("Télécharger cette vidéo!","Télécharger","Télécharger format spécifique")}if(e=="ar"){n=Array("!تنزيل هذا الفيديو","تنزيل","تنزيل صيغة محددة")}if(e=="hu"){n=Array("Letöltés ezt a videót!","Letöltés","Letöltés meghatározott formátumban")}}var r=chrome.extension.getURL("images/options.png");var i=chrome.extension.getURL("html/options.html");var s=chrome.extension.getURL("images/arrow.png");var o='<div id="styleul" class="yt-uix-tooltip" data-tooltip-text="'+chrome.i18n.getMessage("settingspagetitle")+'"><a href="'+i+'" target="_blank"><img src="'+r+'" /></a></div>';var u=new Array;a();console.log("CHYD - OK - End script")}document.addEventListener("webkitTransitionEnd",function(e){if(e.propertyName==="width"&&e.target.id==="progress"){if($("download")){null}else{runScript()}}},false);runScript()